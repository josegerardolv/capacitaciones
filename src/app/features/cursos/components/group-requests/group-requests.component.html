<app-modal [isOpen]="isOpen" [config]="{ 
            title: 'Solicitudes Pendientes Grupo' + (`: ${group?.name}` || ''), 
            subtitle: 'Seleccione solicitudes para acciones masivas', 
            showHeader: true, 
            padding: true, 
            size: 'fullscreen' }" (modalClose)="closeModal()">

    <div class="p-6" slot="">
        <div class="w-full">
            <!-- Toolbar: Pagination and Bulk Actions -->
            <div class="flex flex-col-reverse md:flex-row md:justify-between md:items-center gap-4 mb-4">
                <app-table-pagination [config]="paginationConfig" [showPageSizeSelector]="true"
                    [showPaginationControls]="false" (pageChange)="onPageChange($event)">
                </app-table-pagination>

                <!-- Bulk Actions Toolbar -->
                <div class="flex gap-3 justify-end" *ngIf="showBulkActions">
                    <app-institutional-button [config]="{variant: 'success', icon: 'check'}"
                        (buttonClick)="processSelected('accept')">
                        Aceptar Seleccionados
                    </app-institutional-button>
                    <app-institutional-button [config]="{variant: 'danger', icon: 'close'}"
                        (buttonClick)="processSelected('reject')">
                        Rechazar Seleccionados
                    </app-institutional-button>
                </div>
            </div>

            <!-- Search Bar -->
            <div class="mb-4">
                <app-table-filters [showGlobalSearch]="true" [globalSearchPlaceholder]="'Buscar por nombre, CURP...'"
                    (globalSearchChange)="filterData($event)">
                </app-table-filters>
            </div>

            <!-- Table -->
            <app-institutional-table [data]="requests" [columns]="tableColumns" [config]="tableConfig"
                [selectedItems]="selectedRequests" (selectionChange)="onSelectionChange($event)">
            </app-institutional-table>

            <!-- Bottom Pagination -->
            <div class="mt-4">
                <app-table-pagination [config]="paginationConfig" [showPageSizeSelector]="false"
                    [showPaginationControls]="true" (pageChange)="onPageChange($event)">
                </app-table-pagination>
            </div>
        </div>
    </div>

</app-modal>

<!-- Actions Template (Moved outside *ngIf to ensure availability) -->
<ng-template #actionsTemplate let-item>
    <div class="flex items-center justify-center gap-2">
        <app-institutional-button [config]="{
                variant: 'success', 
                size: 'small', 
                icon: 'check',
                iconPosition: 'only'}" (buttonClick)="acceptRequest(item.id)">
        </app-institutional-button>

        <app-institutional-button [config]="{
                variant: 'danger', 
                size: 'small', 
                icon: 'close',
                iconPosition: 'only'}" (buttonClick)="rejectRequest(item.id)">
        </app-institutional-button>
    </div>
</ng-template>

<!-- Modales Genéricos de Confirmación -->
<app-confirmation-modal [isOpen]="isConfirmOpen" [config]="confirmConfig" (confirm)="onConfirmYes()"
    (cancel)="isConfirmOpen = false" (modalClose)="isConfirmOpen = false">
</app-confirmation-modal>
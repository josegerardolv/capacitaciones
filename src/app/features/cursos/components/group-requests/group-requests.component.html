<app-modal [isOpen]="isOpen" [config]="{ 
            title: 'Solicitudes Pendientes Grupo' + (`: ${group?.name}` || ''), 
            subtitle: 'Seleccione solicitudes para acciones masivas', 
            showHeader: true, 
            padding: true, 
            size: 'fullscreen' }" (modalClose)="closeModal()">

    <div class="p-6" slot="">
        <div class="w-full">
            <!-- Search and Bulk Actions -->
            <div class="mb-4 flex flex-col md:flex-row md:justify-between gap-4">
                <!-- Search Bar -->
                <div class="relative w-full md:w-96">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <span class="material-symbols-outlined text-gray-400">search</span>
                    </div>
                    <input [formControl]="searchControl" type="text" placeholder="Buscar por nombre, CURP..."
                        class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-institucional-primario focus:border-institucional-primario sm:text-sm transition duration-150 ease-in-out"
                        autocomplete="off">
                </div>

                <!-- Bulk Actions Toolbar -->
                <div class="flex gap-3 justify-end" *ngIf="showBulkActions">
                    <app-institutional-button [config]="{variant: 'success', icon: 'check'}"
                        (buttonClick)="processSelected('accept')">
                        Aceptar Seleccionados
                    </app-institutional-button>
                    <app-institutional-button [config]="{variant: 'danger', icon: 'close'}"
                        (buttonClick)="processSelected('reject')">
                        Rechazar Seleccionados
                    </app-institutional-button>
                </div>

                <app-table-pagination [config]="paginationConfig" [showPageSizeSelector]="true"
                    [showPaginationControls]="false" (pageChange)="onPageChange($event)">
                </app-table-pagination>
                <app-institutional-table [data]="requests" [columns]="tableColumns" [config]="tableConfig"
                    [selectedItems]="selectedRequests" (selectionChange)="onSelectionChange($event)">
                </app-institutional-table>
                <app-table-pagination [config]="paginationConfig" [showPageSizeSelector]="false"
                    [showPaginationControls]="true" (pageChange)="onPageChange($event)">
                </app-table-pagination>
            </div>
        </div>
    </div>

</app-modal>

<!-- Actions Template (Moved outside *ngIf to ensure availability) -->
<ng-template #actionsTemplate let-item>
    <div class="flex items-center justify-center gap-2">
        <app-institutional-button [config]="{
                variant: 'success', 
                size: 'small', 
                icon: 'check',
                iconPosition: 'only'}" (buttonClick)="acceptRequest(item.id)">
        </app-institutional-button>

        <app-institutional-button [config]="{
                variant: 'danger', 
                size: 'small', 
                icon: 'close',
                iconPosition: 'only'}" (buttonClick)="rejectRequest(item.id)">
        </app-institutional-button>
    </div>
</ng-template>

<!-- Modales Genéricos de Confirmación -->
<app-confirmation-modal [isOpen]="isConfirmOpen" [config]="confirmConfig" (confirm)="onConfirmYes()"
    (cancel)="isConfirmOpen = false" (modalClose)="isConfirmOpen = false">
</app-confirmation-modal>